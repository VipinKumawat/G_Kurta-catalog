<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Group Kurta Order</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    .active-tab {
      background-color: #2563eb;
      color: white;
    }
  </style>
</head>
<body class="bg-gray-100 text-gray-800 p-4">
  <div class="max-w-xl mx-auto bg-white rounded-xl shadow-xl p-4">
    <h1 class="text-xl font-bold text-center mb-4">Group Kurta Order</h1>

    <!-- Selectors -->
    <div class="space-y-3 mb-4">
      <select id="typeSelect" class="w-full p-2 border rounded">
        <option value="">Select Kurta Type</option>
      </select>
      <select id="numberSelect" class="w-full p-2 border rounded">
        <option value="">Select Kurta Number</option>
      </select>
      <select id="colorSelect" class="w-full p-2 border rounded">
        <option value="">Select Kurta Color</option>
      </select>
    </div>

    <!-- Photo Preview -->
    <div id="preview" class="mb-4 hidden">
      <img id="previewImage" src="" class="w-full rounded-lg shadow-lg">
      <p id="previewText" class="text-center mt-2 text-sm text-gray-600"></p>
    </div>

    <!-- Category Tabs -->
    <div class="flex justify-between mb-2">
      <button onclick="showCategory('Mens')" class="tab-btn w-full mx-1 py-2 rounded bg-gray-200">ğŸ‘¨â€ğŸ¦± MEN</button>
      <button onclick="showCategory('Ladies')" class="tab-btn w-full mx-1 py-2 rounded bg-gray-200">ğŸ‘© LADIES</button>
      <button onclick="showCategory('Kids')" class="tab-btn w-full mx-1 py-2 rounded bg-gray-200">ğŸ‘¶ KIDS</button>
    </div>

    <!-- Sizes Grid -->
    <div id="sizeContainer" class="mb-4 space-y-2"></div>

    <!-- Group Info -->
    <div class="space-y-2">
      <input type="text" id="groupName" placeholder="ğŸ‘¥ Group Name" class="w-full p-2 border rounded">
      <input type="text" id="address" placeholder="ğŸ  Address" class="w-full p-2 border rounded">
      <input type="text" id="contact" placeholder="ğŸ“ Contact Number" class="w-full p-2 border rounded">
    </div>

    <!-- Final Message Button -->
    <button onclick="generateMessage()" class="mt-4 w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700">
      ğŸ“© Generate WhatsApp Message
    </button>

    <!-- Output -->
    <textarea id="output" rows="10" class="w-full mt-4 p-2 border rounded text-sm"></textarea>
  </div>

  <!-- Product JSON -->
  <script src="product.js"></script>

  <!-- Script Logic -->
  <script>
    const typeSelect = document.getElementById('typeSelect');
    const numberSelect = document.getElementById('numberSelect');
    const colorSelect = document.getElementById('colorSelect');
    const preview = document.getElementById('preview');
    const previewImage = document.getElementById('previewImage');
    const previewText = document.getElementById('previewText');
    const sizeContainer = document.getElementById('sizeContainer');

    let selectedProduct = null;
    let currentCategory = 'Mens';

    // Initialize Dropdowns
    const types = [...new Set(products.map(p => p.type))];
    types.forEach(type => {
      const opt = document.createElement('option');
      opt.value = type;
      opt.textContent = type;
      typeSelect.appendChild(opt);
    });

    typeSelect.addEventListener('change', () => {
      numberSelect.innerHTML = '<option value="">Select Kurta Number</option>';
      const selectedType = typeSelect.value;
      const filtered = products.filter(p => p.type === selectedType);
      [...new Set(filtered.map(p => p.number))].forEach(num => {
        const opt = document.createElement('option');
        opt.value = num;
        opt.textContent = num;
        numberSelect.appendChild(opt);
      });
    });

    numberSelect.addEventListener('change', () => {
      colorSelect.innerHTML = '<option value="">Select Kurta Color</option>';
      const filtered = products.filter(p => p.type === typeSelect.value && p.number === numberSelect.value);
      filtered.forEach(p => {
        const opt = document.createElement('option');
        opt.value = p.color;
        opt.textContent = p.color;
        colorSelect.appendChild(opt);
      });
    });

    colorSelect.addEventListener('change', () => {
      const found = products.find(p =>
        p.type === typeSelect.value &&
        p.number === numberSelect.value &&
        p.color === colorSelect.value
      );
      if (found) {
        selectedProduct = found;
        const imgPath = `Catlogue_icon/${found.type}-page-${found.page}.jpg`;
        previewImage.src = imgPath;
        previewText.textContent = `Preview: ${found.type} #${found.number} (${found.color})`;
        preview.classList.remove('hidden');
        showSizes();
      }
    });

    function showCategory(cat) {
      currentCategory = cat;
      document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active-tab'));
      event.target.classList.add('active-tab');
      showSizes();
    }

    function showSizes() {
      if (!selectedProduct) return;
      sizeContainer.innerHTML = '';
      const sizes = selectedProduct.pricing[currentCategory];
      if (!sizes) {
        sizeContainer.innerHTML = '<p class="text-sm text-center text-gray-500">No sizes available</p>';
        return;
      }

      for (const size in sizes) {
        const price = sizes[size]['Discount Price'];
        const div = document.createElement('div');
        div.innerHTML = `
          <label class="flex items-center justify-between p-2 border rounded">
            <span>${size} â€“ â‚¹${price}</span>
            <input type="number" min="0" placeholder="Qty" class="w-16 p-1 border rounded" data-size="${size}">
          </label>
        `;
        sizeContainer.appendChild(div);
      }
    }

    function generateMessage() {
      if (!selectedProduct) return alert("Please select product first.");

      let msg = `ğŸ§¥ Product: ${selectedProduct.type} #${selectedProduct.number} â€“ ${selectedProduct.color}\n\n`;

      for (const category of ['Mens', 'Ladies', 'Kids']) {
        const sizes = selectedProduct.pricing[category];
        if (!sizes) continue;
        let catMsg = '';
        for (const size in sizes) {
          const input = document.querySelector(`input[data-size="${size}"]`);
          if (input && parseInt(input.value) > 0) {
            catMsg += `${size} â€“ ${input.value}, `;
          }
        }
        if (catMsg) {
          msg += (category === 'Mens' ? 'ğŸ‘¨â€ğŸ¦± MEN' : category === 'Ladies' ? 'ğŸ‘© LADIES' : 'ğŸ‘¶ KIDS') + ":\n" + catMsg.slice(0, -2) + "\n\n";
        }
      }

      msg += `ğŸ‘¥ Group Name: ${groupName.value}\nğŸ  Address: ${address.value}\nğŸ“ Contact Number: ${contact.value}`;
      document.getElementById('output').value = msg;
    }
  </script>
</body>
</html>